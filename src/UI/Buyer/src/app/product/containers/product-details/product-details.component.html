<div class="container mt-4" *ngIf="!product">
  <shared-no-results
    message="This product is no longer available"
    actionText="shop available products"
    (action)="routeToProductList()"
  ></shared-no-results>
</div>
<div class="container mt-4" *ngIf="product">
  <div class="row mb-5">
    <div class="col-md-6">
      <div class="position-relative d-block">
        <product-additional-image-gallery
          [imgUrls]="product?.xp?.imageURLs"
        ></product-additional-image-gallery>
      </div>
    </div>
    <div class="col-md-6 bg-light">
      <h1 class="h1 my-0">{{ product.Name }}</h1>
      <span class="text-muted">ID: {{ product.ID }}</span>
      <span class="ml-3">
        <shared-toggle-favorite
          title="Favorite"
          (click)="$event.stopPropagation()"
          [favorite]="favoriteProductService.isFavorite(product)"
          (favoriteChanged)="
            favoriteProductService.setFavoriteValue($event, product)
          "
        >
        </shared-toggle-favorite>
      </span>
      <hr />
      <div *ngIf="isOrderable(); else: viewOnly">
        <shared-quantity-input
          class="d-inline-block"
          style="max-width: 100px"
          [product]="product"
          (addedToCart)="addToCart($event)"
        >
        </shared-quantity-input>
        <button
          class="btn btn-primary ml-2"
          type="submit"
          (click)="quantityInputComponent.addToCart($event)"
        >
          Add to Cart
          <span class="badge badge-light ml-2">{{
            getTotalPrice() | currency
          }}</span>
        </button>
      </div>
      <ng-template #viewOnly>
        <div class="alert alert-info">
          This is a view-only product and cannot be ordered
        </div>
      </ng-template>
      <div class="mt-5">
        <ngb-tabset>
          <ngb-tab title="Details">
            <ng-template ngbTabContent>
              <p class="mt-4">
                {{ product.Description || 'This product has no description.' }}
              </p>
            </ng-template>
          </ngb-tab>
          <ngb-tab *ngIf="isOrderable()" title="Price Breaks">
            <ng-template ngbTabContent>
              <product-price-schedule
                [product]="product"
              ></product-price-schedule>
            </ng-template>
          </ngb-tab>
          <ngb-tab *ngIf="(specs$ | async); let specs" title="Specs">
            <ng-template ngbTabContent>
              <product-specs
                [specs]="specs"
                (specFormChanges)="formChanges($event)"
              ></product-specs>
            </ng-template>
          </ngb-tab>
        </ngb-tabset>
      </div>
    </div>
  </div>
  <div *ngIf="(relatedProducts$ | async); let relatedProducts">
    <product-carousel
      *ngIf="relatedProducts.length > 0"
      displayTitle="Related Products"
      [products]="relatedProducts"
    >
    </product-carousel>
  </div>
</div>
